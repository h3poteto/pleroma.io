version: "3.0"
services:
  elixir:
    image: ghcr.io/h3poteto/elixir:1.10.4-slim-buster
    working_dir: /var/opt/app
    environment:
      MIX_ENV: dev
      ROLLBAR_ACCESS_TOKEN: dummy
    volumes:
      - .:/var/opt/app
    ports:
      - "4000:4000"
    links:
      - db:db

  db:
    image: postgres:11.2-alpine
    environment:
      POSTGRES_USER: pleroma
      POSTGRES_PASSWORD: pleroma
      POSTGRES_DB: pleroma_dev
    volumes:
      - storage:/var/lib/postgres/data
      - ./config:/var/opt/pleroma/config

volumes:
  storage:
